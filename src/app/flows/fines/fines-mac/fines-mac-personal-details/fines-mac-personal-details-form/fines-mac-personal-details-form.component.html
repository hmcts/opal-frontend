<h1 class="govuk-heading-l">Personal details</h1>
<app-govuk-error-summary [errors]="formErrorSummaryMessage" (errorClick)="scrollTo($event)"></app-govuk-error-summary>
<form (submit)="handleFormSubmit($event)" [formGroup]="form">
  <app-govuk-select
    labelText="Title"
    labelClasses="govuk-label--s"
    selectId="title"
    selectName="title"
    [options]="titleOptions"
    [control]="form.controls['title']"
    [errors]="formControlErrorMessages['title']"
  ></app-govuk-select>
  <app-fines-mac-name
    [form]="form"
    [formControlErrorMessages]="formControlErrorMessages"
    [nameFieldIds]="customNameFieldIds"
    componentName="personalDetails"
  ></app-fines-mac-name>
  <app-fines-mac-name-alias
    [form]="form"
    [formControlErrorMessages]="formControlErrorMessages"
    [aliasControls]="aliasControls"
    (addAlias)="addAlias($event.aliasControlLength, $event.aliasFieldName)"
    (removeAlias)="removeAlias($event.aliasControlLength, $event.aliasFieldName)"
    componentName="personalDetails"
  ></app-fines-mac-name-alias>
  <app-fines-mac-date-of-birth
    [form]="form"
    [formControlErrorMessages]="formControlErrorMessages"
    (dateChange)="setInputValue($event, 'dob')"
    componentName="personalDetails"
  ></app-fines-mac-date-of-birth>
  @if (age && ageLabel) {
    <app-moj-ticket-panel componentClasses="govuk-!-width-one-third" sectionClasses="moj-ticket-panel__content--blue">
      <strong>Age: {{ age }}</strong>
      <p>{{ ageLabel }}</p>
    </app-moj-ticket-panel>
  }
  <app-fines-mac-national-insurance-number
    [form]="form"
    [formControlErrorMessages]="formControlErrorMessages"
    componentName="personalDetails"
  ></app-fines-mac-national-insurance-number>
  <app-fines-mac-address-block
    [divider]="true"
    legendText="Address"
    [form]="form"
    [formControlErrorMessages]="formControlErrorMessages"
    [addressFieldIds]="customAddressFieldIds"
    componentName="personalDetails"
  ></app-fines-mac-address-block>
  @if (defendantType === 'adultOrYouthOnly') {
    <app-fines-mac-vehicle-details
      [divider]="true"
      legendText="Vehicle details"
      [form]="form"
      [formControlErrorMessages]="formControlErrorMessages"
      [vehicleDetailsFieldIds]="customVehicleDetailsFieldIds"
      componentName="personalDetails"
    ></app-fines-mac-vehicle-details>
  }
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <app-govuk-button buttonId="submitForm" type="submit"> Return to account details </app-govuk-button>
      @if (defendantType && finesMacNestedRoutes[defendantType].personalDetails) {
        <app-govuk-button
          buttonId="submitForm"
          type="submit"
          buttonClasses="nested-flow govuk-button--secondary govuk-!-margin-left-3"
        >
          {{ finesMacNestedRoutes[defendantType].personalDetails?.buttonText }}
        </app-govuk-button>
      }
    </div>
  </div>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <app-govuk-cancel-link
        (linkClickEvent)="handleRoute(fineMacRoutingPaths.children.accountDetails)"
      ></app-govuk-cancel-link>
    </div>
  </div>
</form>
