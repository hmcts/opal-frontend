<opal-lib-custom-horizontal-scroll-pane>
  <opal-lib-moj-sortable-table>
    <ng-container head>
      <th
        opal-lib-moj-sortable-table-header
        columnKey="Account"
        [sortDirection]="sortStateSignal()['Account']"
        (sortChange)="onSortChange($event)"
        [dataIndex]="0"
      >
        Account
      </th>
      <th
        opal-lib-moj-sortable-table-header
        columnKey="Name"
        [sortDirection]="sortStateSignal()['Name']"
        (sortChange)="onSortChange($event)"
        [dataIndex]="1"
      >
        Name
      </th>
      <th
        opal-lib-moj-sortable-table-header
        columnKey="Address line 1"
        [sortDirection]="sortStateSignal()['Address line 1']"
        (sortChange)="onSortChange($event)"
        [dataIndex]="2"
      >
        Address line 1
      </th>
      <th
        opal-lib-moj-sortable-table-header
        columnKey="Postcode"
        [sortDirection]="sortStateSignal()['Postcode']"
        (sortChange)="onSortChange($event)"
        [dataIndex]="3"
      >
        Postcode
      </th>
      <th
        opal-lib-moj-sortable-table-header
        columnKey="Business unit"
        [sortDirection]="sortStateSignal()['Business unit']"
        (sortChange)="onSortChange($event)"
        [dataIndex]="4"
      >
        Business unit
      </th>
      <th
        opal-lib-moj-sortable-table-header
        columnKey="Defendant"
        [sortDirection]="sortStateSignal()['Defendant']"
        (sortChange)="onSortChange($event)"
        [dataIndex]="5"
      >
        Defendant
      </th>
      <th
        opal-lib-moj-sortable-table-header
        columnKey="Balance"
        [sortDirection]="sortStateSignal()['Balance']"
        (sortChange)="onSortChange($event)"
        [dataIndex]="6"
      >
        Balance
      </th>
    </ng-container>
    <ng-container row>
      @for (row of paginatedTableDataComputed(); track row['Account']) {
        <tr opal-lib-moj-sortable-table-row>
          <td opal-lib-moj-sortable-table-row-data id="accountNumber">
            <app-fines-sa-results-shared-table-cell [value]="row['Account']">
              @if (row['Creditor account id'] !== null) {
                <a
                  class="govuk-link govuk-link--no-visited-state"
                  tabindex="0"
                  (click)="goToAccount(row['Creditor account id'])"
                  (keyup.enter)="goToAccount(row['Creditor account id'])"
                  >{{ row['Account'] }}</a
                >
              } @else {
                {{ row['Account'] }}
              }
            </app-fines-sa-results-shared-table-cell>
          </td>
          <td opal-lib-moj-sortable-table-row-data id="name">
            <app-fines-sa-results-shared-table-cell [value]="row['Name']">
              {{ row['Name'] }}
            </app-fines-sa-results-shared-table-cell>
          </td>
          <td opal-lib-moj-sortable-table-row-data id="addressLine1">
            <app-fines-sa-results-shared-table-cell [value]="row['Address line 1']">
              {{ row['Address line 1'] }}
            </app-fines-sa-results-shared-table-cell>
          </td>
          <td opal-lib-moj-sortable-table-row-data id="postcode">
            <app-fines-sa-results-shared-table-cell [value]="row['Postcode']">
              {{ row['Postcode'] }}
            </app-fines-sa-results-shared-table-cell>
          </td>
          <td opal-lib-moj-sortable-table-row-data id="businessUnit">
            <app-fines-sa-results-shared-table-cell [value]="row['Business unit']">
              {{ row['Business unit'] }}
            </app-fines-sa-results-shared-table-cell>
          </td>
          <td opal-lib-moj-sortable-table-row-data id="defendant">
            <app-fines-sa-results-shared-table-cell [value]="row['Defendant']">
              @if (row['Defendant account id'] !== null) {
                <a
                  class="govuk-link govuk-link--no-visited-state"
                  tabindex="0"
                  (click)="goToAccount(row['Defendant account id'])"
                  (keyup.enter)="goToAccount(row['Defendant account id'])"
                  >{{ row['Defendant'] }}</a
                >
              } @else {
                {{ row['Defendant'] }}
              }
            </app-fines-sa-results-shared-table-cell>
          </td>
          <td opal-lib-moj-sortable-table-row-data id="balance">
            <app-fines-sa-results-shared-table-cell [value]="row['Balance']">
              {{ row['Balance'] | currency: 'GBP' }}
            </app-fines-sa-results-shared-table-cell>
          </td>
        </tr>
      }
    </ng-container>
    <app-fines-sa-results-shared-table-status
      [columnTitle]="sortedColumnTitleSignal()"
      [sortDirection]="sortedColumnDirectionSignal()"
    />
  </opal-lib-moj-sortable-table>
</opal-lib-custom-horizontal-scroll-pane>

<app-fines-sa-results-shared-pagination
  paginationId="fines-draft-table-pagination"
  [currentPage]="currentPageSignal()"
  [itemsPerPage]="itemsPerPageSignal()"
  [totalItems]="filteredTableDataSignal().length"
  [currentPageItems]="paginatedTableDataComputed().length"
  (changePage)="onPageChange($event)"
></app-fines-sa-results-shared-pagination>
