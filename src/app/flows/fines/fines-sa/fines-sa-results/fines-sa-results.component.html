<opal-lib-govuk-back-link (clickEvent)="navigateBackToSearch()"></opal-lib-govuk-back-link>
<h1 class="govuk-heading-l">Search results</h1>

@switch (resultView) {
  @case ('accountNumber') {
    <ng-container *ngTemplateOutlet="multipleTypes"></ng-container>
  }
  @case ('referenceCaseNumber') {
    <ng-container *ngTemplateOutlet="multipleTypes"></ng-container>
  }
  @case ('individuals') {
    <ng-container *ngTemplateOutlet="individuals"></ng-container>
  }
  @case ('companies') {
    <ng-container *ngTemplateOutlet="companies"></ng-container>
  }
  @case ('minorCreditors') {
    <ng-container *ngTemplateOutlet="minorCreditors"></ng-container>
  }
}

<ng-template #multipleTypes>
  @if (individualsData.length > 0 || companiesData.length > 0 || minorCreditorsData.length > 0) {
    <opal-lib-govuk-tabs tabId="resultTypes">
      <ng-container tab-list-items>
        @if (individualsData.length > 0) {
          <li
            opal-lib-govuk-tabs-list-item
            tabItemFragment="individuals"
            tabItemId="tab-individuals"
            [activeTabItemFragment]="finesSaStore.resultsActiveTab()"
          >
            <ng-content [linkText]>Individuals</ng-content>
          </li>
        }
        @if (companiesData.length > 0) {
          <li
            opal-lib-govuk-tabs-list-item
            tabItemFragment="companies"
            tabItemId="tab-companies"
            [activeTabItemFragment]="finesSaStore.resultsActiveTab()"
          >
            <ng-content [linkText]>Companies</ng-content>
          </li>
        }
        @if (minorCreditorsData.length > 0) {
          <li
            opal-lib-govuk-tabs-list-item
            tabItemFragment="minorCreditors"
            tabItemId="tab-minor-creditors"
            [activeTabItemFragment]="finesSaStore.resultsActiveTab()"
          >
            <ng-content [linkText]>Minor creditors</ng-content>
          </li>
        }
      </ng-container>
      <ng-container tab-panels>
        @switch (finesSaStore.resultsActiveTab()) {
          @case ('individuals') {
            @if (individualsData.length > 0) {
              <opal-lib-govuk-tabs-panel id="individuals">
                <ng-container *ngTemplateOutlet="individuals"></ng-container
              ></opal-lib-govuk-tabs-panel>
            }
          }
          @case ('companies') {
            @if (companiesData.length > 0) {
              <opal-lib-govuk-tabs-panel id="companies">
                <ng-container *ngTemplateOutlet="companies"></ng-container
              ></opal-lib-govuk-tabs-panel>
            }
          }
          @case ('minorCreditors') {
            @if (minorCreditorsData.length > 0) {
              <opal-lib-govuk-tabs-panel id="minorCreditors">
                <ng-container *ngTemplateOutlet="minorCreditors"></ng-container
              ></opal-lib-govuk-tabs-panel>
            }
          }
        }
      </ng-container>
    </opal-lib-govuk-tabs>
  } @else {
    <ng-container *ngTemplateOutlet="noResults"></ng-container>
  }
</ng-template>

<ng-template #individuals>
  @if (individualsData.length > 0 && individualsData.length <= 100) {
    <app-fines-sa-results-defendant-table-wrapper
      [tableData]="individualsData"
      [existingSortState]="defendantsSort"
      (accountIdClicked)="onAccountIdClick($event)"
    >
    </app-fines-sa-results-defendant-table-wrapper>
  } @else if (individualsData.length === 0) {
    <ng-container *ngTemplateOutlet="noResults"></ng-container>
  } @else {
    <ng-container *ngTemplateOutlet="tooManyResults"></ng-container>
  }
</ng-template>
<ng-template #companies>
  @if (companiesData.length > 0 && companiesData.length <= 100) {
    <app-fines-sa-results-defendant-table-wrapper
      [tableData]="companiesData"
      [existingSortState]="defendantsSort"
      [isCompany]="true"
      (accountIdClicked)="onAccountIdClick($event)"
    >
    </app-fines-sa-results-defendant-table-wrapper>
  } @else if (companiesData.length === 0) {
    <ng-container *ngTemplateOutlet="noResults"></ng-container>
  } @else {
    <ng-container *ngTemplateOutlet="tooManyResults"></ng-container>
  }
</ng-template>
<ng-template #minorCreditors>
  <p>Minor creditors Results</p>
</ng-template>

<ng-template #noResults>
  <h2 class="govuk-heading-m">There are no matching results</h2>
  <p class="govuk-body-m">
    <a href="#" class="govuk-link" tabindex="0" (click)="navigateBackToSearch()" (keyup.enter)="navigateBackToSearch()"
      >Check your search</a
    >
    and try again
  </p>
</ng-template>
<ng-template #tooManyResults>
  <h2 class="govuk-heading-m">There are more than 100 results</h2>
  <p class="govuk-body-m">
    <a href="#" class="govuk-link" tabindex="0" (click)="navigateBackToSearch()" (keyup.enter)="navigateBackToSearch()"
      >Try adding more information</a
    >
    to your search
  </p>
</ng-template>
