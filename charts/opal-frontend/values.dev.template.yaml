nodejs:
  # Don't modify below here
  image: ${IMAGE_NAME}
  ingressHost: ${SERVICE_FQDN}
  keyVaults:
    opal:
      secrets:
        - AppInsightsInstrumentationKey
  environment:
    REDIS_CONNECTION_STRING: redis://${SERVICE_NAME}-redis-master:6379
    OPAL_API_URL: https://opal-fines-service-${SERVICE_FQDN}

opal-fines-service:
  enabled: true
  java:
    releasaeNameOverride: ${SERVICE_NAME}-opal-fines-service
    ingressHost: opal-fines-service-${SERVICE_FQDN}
    keyVaults:
      opal:
        secrets:
          - name: app-insights-connection-string
            alias: app-insights-connection-string
          - name: AzureADTenantId
            alias: AAD_TENANT_ID
          - name: AzureADClientId
            alias: AAD_CLIENT_ID
          - name: AzureADClientSecret
            alias: AAD_CLIENT_SECRET
    environment:
      OPAL_FINES_DB_HOST: "{{ .Release.Name }}-postgresql"
      OPAL_FINES_DB_NAME: "{{ .Values.postgresql.auth.database}}"
      OPAL_FINES_DB_USERNAME: "{{ .Values.postgresql.auth.username}}"
      OPAL_FINES_DB_PASSWORD: "{{ .Values.postgresql.auth.password}}"
      OPAL_FINES_DB_OPTIONS: "?stringtype=unspecified"
      OPAL_FINES_DB_PORT: 5432
      RUN_DB_MIGRATION_ON_STARTUP: true
      OPAL_FRONTEND_URL: https://${SERVICE_FQDN}
  postgresql:
    enabled: true

redis:
  enabled: true
  architecture: standalone
  master:
    persistence:
      enabled: false
  auth:
    enabled: false
